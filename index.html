<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

<title>Rock Â· Paper Â· Scissors</title>

<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}

/* Theme */
:root{
--bg:#f0eeeb;--text:#111;--muted:rgba(0,0,0,0.28);--border:rgba(0,0,0,0.08);
--surface:rgba(255,255,255,0.7);--btn:#111;--btn-fg:#f0eeeb;
--win:#1a7a42;--lose:#b52038;--tie:#666;--tr:.34s cubic-bezier(.4,0,.2,1)
}
[data-theme=dark]{
--bg:#0c0c0c;--text:#f0eeeb;--muted:rgba(240,238,235,0.28);--border:rgba(240,238,235,0.08);
--surface:rgba(24,24,24,0.88);--btn:#f0eeeb;--btn-fg:#0c0c0c;
--win:#50c87c;--lose:#e0506a;--tie:#aaa
}

html,body{
height:100%;
font-family:Outfit,sans-serif;
background:var(--bg);
color:var(--text);
display:flex;
flex-direction:column;
align-items:center;
max-width:430px;
margin:0 auto;
overflow:hidden;
transition:background var(--tr),color var(--tr)
}

/* Header */
.hdr{width:100%;display:flex;align-items:center;justify-content:space-between;padding:16px 20px 0}
.hdr-title{font-size:.56rem;letter-spacing:4px;text-transform:uppercase;color:var(--muted)}
.hdr-right{display:flex;gap:12px;align-items:center}

/* Network */
.net-status{display:flex;gap:6px;font-size:.55rem;text-transform:uppercase;color:var(--muted)}
.net-dot{width:8px;height:8px;border-radius:50%;background:#50c87c}
.net-dot.offline{background:#e0506a}

/* Buttons */
.speaker-btn{width:30px;height:30px;border:none;background:none;color:var(--muted);cursor:pointer}
.toggle{width:36px;height:20px;background:var(--border);border-radius:20px;border:1px solid var(--border);cursor:pointer;position:relative}
.toggle::after{content:'';position:absolute;width:13px;height:13px;background:var(--text);border-radius:50%;top:50%;left:3px;transform:translateY(-50%);transition:all var(--tr)}
[data-theme=dark] .toggle::after{left:calc(100% - 16px)}

/* Score */
.score-wrap{display:flex;gap:8px;margin-top:12px}
.score-pill{background:var(--surface);border:1px solid var(--border);border-radius:50px;padding:6px 16px;display:flex;gap:7px}
.sl{font-size:.55rem;letter-spacing:2px;text-transform:uppercase;color:var(--muted)}
.sn{font-weight:600}

/* Stage */
.stage-wrap{flex:1;width:100%;display:flex;align-items:center;justify-content:center}
.stage{width:100%;display:flex;align-items:flex-end;justify-content:center;padding-bottom:12px}
.obj{flex:1;display:flex;flex-direction:column;align-items:center;cursor:pointer;transition:.4s}
.obj img{display:block;object-fit:contain;animation:float 4s ease-in-out infinite}
#o-rock img{height:clamp(140px,32vw,190px)}
#o-paper img{height:clamp(110px,25vw,155px)}
#o-scissors img{height:clamp(148px,34vw,198px)}
.obj.selected{transform:translateY(-12px) scale(1.04)}
.obj.dimmed{opacity:0;transform:scale(.7) translateY(20px)}
.obj-lbl{font-size:.5rem;letter-spacing:2.5px;text-transform:uppercase;color:var(--muted)}

@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}

/* Play Buttons */
.play-row{padding:10px 20px;width:100%;display:flex;flex-direction:column;gap:10px}
.pbtn{background:var(--btn);color:var(--btn-fg);border:none;border-radius:50px;padding:13px;font-size:.76rem;letter-spacing:2px;text-transform:uppercase;cursor:pointer}
.cbtn{border:1px solid var(--border);border-radius:50px;padding:8px;font-size:.6rem;text-transform:uppercase;background:none;color:var(--muted);cursor:pointer}

/* Overlay */
.win-overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.2);backdrop-filter:blur(3px);opacity:0;pointer-events:none;transition:.4s}
.win-overlay.show{opacity:1;pointer-events:all}
.win-card{background:var(--surface);border-radius:24px;padding:32px;text-align:center}
</style>
</head>

<body>

<div class="hdr">
<span class="hdr-title">RPS</span>
<div class="hdr-right">
<div class="net-status">
<div class="net-dot" id="net-dot"></div>
<span id="net-lbl">Online</span>
</div>

<button class="speaker-btn" onclick="toggleMute()">ðŸ”Š</button>
<button class="toggle" onclick="toggleTheme()"></button>
</div>
</div>

<div class="score-wrap">
<div class="score-pill"><span class="sl">You</span><span id="s1">0</span></div>
<div class="score-pill"><span id="s2">0</span><span class="sl" id="p2lbl">CPU</span></div>
</div>

<div class="stage-wrap">
<div class="stage">
<div class="obj" id="o-rock" onclick="pick('rock')">
<img id="i-rock"><div class="obj-lbl">Rock</div>
</div>

<div class="obj" id="o-paper" onclick="pick('paper')">
<img id="i-paper"><div class="obj-lbl">Paper</div>
</div>

<div class="obj" id="o-scissors" onclick="pick('scissors')">
<img id="i-scissors"><div class="obj-lbl">Scissors</div>
</div>
</div>
</div>

<div class="play-row">
<button class="pbtn" id="pbtn" onclick="startRound()" disabled>Play</button>
<button class="cbtn" onclick="initChallenge()">Challenge a Friend</button>
</div>

<div class="win-overlay" id="win-ov">
<div class="win-card">
<h2 id="win-title">Result</h2>
<button class="pbtn" onclick="rematch()">Next Round</button>
</div>
</div>

<audio id="bgm" loop></audio>

<script>
/* Assets */
const ASSETS={
rock:{dark:'black-rock-rps.PNG',light:'white-rock-rps.PNG'},
paper:{dark:'black-paper-rps.PNG',light:'white-paper-rps.PNG'},
scissors:{dark:'black-scissors-rps.PNG',light:'white-scissors-rps.PNG'}
};

const OFFLINE={
rock:'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="gray"/></svg>',
paper:'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" fill="gray"/></svg>',
scissors:'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 4l16 16M4 20L20 4" stroke="gray" stroke-width="4"/></svg>'
};

function loadImages(theme){
['rock','paper','scissors'].forEach(x=>{
const img=document.getElementById("i-"+x);
img.onerror=()=>img.src=OFFLINE[x];
img.src=ASSETS[x][theme];
});
}

/* Game State */
let myScore=0,oppScore=0,myMove=null,oppMove=null;
let peer=null,conn=null;

window.onload=()=>{
loadImages("dark");
peer=new Peer(Math.random().toString(36).substring(2,8));
};

/* Theme */
function toggleTheme(){
const root=document.documentElement;
const newTheme=root.getAttribute("data-theme")==="dark"?"light":"dark";
root.setAttribute("data-theme",newTheme);
loadImages(newTheme);
}

/* Pick */
function pick(c){
myMove=c;
document.querySelectorAll(".obj").forEach(e=>e.classList.remove("selected","dimmed"));
document.getElementById("o-"+c).classList.add("selected");
document.querySelectorAll(".obj").forEach(e=>{if(!e.classList.contains("selected"))e.classList.add("dimmed")});
document.getElementById("pbtn").disabled=false;
}

/* Play */
function startRound(){
const arr=["rock","paper","scissors"];
oppMove=arr[Math.floor(Math.random()*3)];
resolveRound();
}

/* Resolve */
function resolveRound(){
let r="tie";
if((myMove==="rock"&&oppMove==="scissors")||(myMove==="paper"&&oppMove==="rock")||(myMove==="scissors"&&oppMove==="paper")){r="win";myScore++}
else if(myMove!==oppMove){r="lose";oppScore++}

document.getElementById("s1").innerText=myScore;
document.getElementById("s2").innerText=oppScore;

showResult(r);
}

/* Result */
function showResult(r){
const ov=document.getElementById("win-ov");
document.getElementById("win-title").innerText=r==="win"?"You Won!":r==="lose"?"CPU Won":"Tie";
ov.classList.add("show");
}

function rematch(){
document.getElementById("win-ov").classList.remove("show");
document.querySelectorAll(".obj").forEach(e=>e.classList.remove("selected","dimmed"));
myMove=null;
}

/* Share */
function initChallenge(){
const link=location.href;
if(navigator.share){
navigator.share({title:"Play RPS",text:"Join me!",url:link});
}else{
window.location=`sms:?body=Play RPS ${link}`;
}
}

function toggleMute(){
const bgm=document.getElementById("bgm");
bgm.paused?bgm.play():bgm.pause();
}
</script>

</body>
</html>
